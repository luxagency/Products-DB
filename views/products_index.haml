- unless params[:widget]
  %h1 Listing products

- unless @products.empty?
  %input(type="hidden" id="category_id" value="#{params[:category_id]}")
  %div.nav
    %a(class="prev browse left")
    %span.nav-text
      %span#page_number 1
      of
      = (@products.count.round(1) / @per_page).ceil
    %a(class="next browse right")
    = haml :share_buttons
  .scrollable{ "data-per-page" => @per_page }
    .items
      - @products.in_groups_of(@per_page) do |group|
        %div.group
          - group.compact.each do |product|
            .item
              %a(href="#{product.local_url(params[:site_id])}" target="blank" id="#{product.id}")
                %img(src="#{product.image_url}")
              %br
              %span
                %a(href="#{product.local_url(params[:site_id])}" target="blank" id="#{product.id}")
                  - if product.brand_name && !product.brand_name.empty? && product.brand_url && !product.brand_url.empty?
                    = succeed '.' do
                      = product.title
                  - else
                    = product.title
                - if product.brand_name && !product.brand_name.empty? && product.brand_url && !product.brand_url.empty?
                  %br
                  by
                  %a(href="#{product.brand_url}" target="blank" id="#{product.id}")
                    = product.brand_name

  .clear
- else
  No products found

  -#var params = window.ladylux.getParams(window.location.href)
  -#if(params["width"] != undefined) {
  -#  if(params["width"] == 1) {
  -#    $(".scrollable").width(700);
  -#    $(".nav").width(700);
  -#  } else if(params["width"] == "2") {
  -#    $(".scrollable").width(580);
  -#    $(".nav").width(580);
  -#  } else if(params["width"] == "3") {
  -#    $(".scrollable").width(418);
  -#    $(".nav").width(418);
  -#    $("#plusone").hide();
  -#  }
  -#}

%br

:javascript
  jQuery(function($){
    var scrollable = $('.scrollable');
    var per_page = scrollable.attr('data-per-page');
    var first_item = $('.item:first', scrollable);
    var inner_width = parseInt(first_item.outerWidth()) + parseInt(first_item.css('margin-left')) + parseInt(first_item.css('margin-right'));
    $('.group', scrollable).add(scrollable).add($('.nav')).width(inner_width*per_page);
    console.log(inner_width, per_page);
  });


